*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:Inter,Segoe UI,Roboto,Arial,sans-serif}
.hidden{display:none}

/* خلفية حسب طلبك */
.wrap{
  position:fixed; inset:0; display:grid; place-items:center;
  pointer-events:none;
}

.wrap.hidden { display:none; opacity:0; visibility:hidden; }

/* اللوح العام */
.board{
  width:1080px; max-width:96vw; height:86vh;
  display:grid; grid-template-columns: 62% 38%; /* الحوار يسار */
  border-radius:16px; border:1px solid rgba(255,255,255,.10);
  background: radial-gradient(100.34% 104.36% at 29.44% -13.62%, #1C2027 0%, #1b5785 0.50%, #21252e 100%);
  box-shadow:0 24px 60px rgba(0,0,0,.55);
  color:#eaf2ff;
  position:relative;
  pointer-events:auto;
}

/* عمود الحوار */
.dialog-col{display:grid; grid-template-rows:auto 1fr auto; border-right:1px solid rgba(255,255,255,.10)}
.right-space{ /* فقط فراغ بصري يمين */ }

/* Header */
.head{display:grid; grid-template-columns:auto 1fr auto; gap:12px; align-items:center;
  padding:10px 14px; border-bottom:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.05)
}
.who{display:flex; align-items:center; gap:10px}
.avatar{width:42px; height:42px; border-radius:10px; display:grid; place-items:center; font-weight:800;
  color:#dff7ff; border:1px solid rgba(255,255,255,.2);
  background: radial-gradient(60% 60% at 30% 20%, rgba(27,87,133,.45), rgba(27,87,133,.20));
}
.meta .name{font-weight:900}
.tag{display:inline-block; margin-top:2px; font-size:12px; padding:3px 8px; border-radius:999px;
  color:#d5eeff; border:1px solid rgba(27,87,133,.55);
  background: linear-gradient(180deg, rgba(27,87,133,.35), rgba(27,87,133,.15));
}
.rep{justify-self:center; display:flex; align-items:center; gap:8px; opacity:.95}
.rep .lbl{font-size:12px; color:#cfe4ff}
.rep .val{font-weight:900; color:#fff}
.nav{display:flex; align-items:center; gap:8px}
.pill{padding:8px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:#d7e9ff; cursor:pointer}
.close{width:34px; height:34px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:#fff; font-size:20px; cursor:pointer}

/* Chat bubbles (يسار = NPC، يمين = أنت) */
.chat{padding:14px; overflow:auto; display:flex; flex-direction:column; gap:10px}
.msg{max-width:78%; padding:12px 14px; border-radius:12px; position:relative;
  background: rgba(33,37,46,.85); border:1px solid rgba(255,255,255,.08); color:#eef6ff;
  box-shadow:0 10px 28px rgba(0,0,0,.28)
}
.msg.npc{align-self:flex-start; border-top-left-radius:8px}
.msg.npc::after{
  content:""; position:absolute; left:10px; top:-6px; width:12px; height:12px; transform:rotate(45deg);
  background: rgba(33,37,46,.85); border-left:1px solid rgba(255,255,255,.08); border-top:1px solid rgba(255,255,255,.08);
}
.msg.me{align-self:flex-end; border-top-right-radius:8px;
  background: linear-gradient(180deg, rgba(27,87,133,.42), rgba(27,87,133,.22));
  border-color: rgba(27,87,133,.55);
}
.msg.me::after{
  content:""; position:absolute; right:10px; top:-6px; width:12px; height:12px; transform:rotate(45deg);
  background: linear-gradient(180deg, rgba(27,87,133,.42), rgba(27,87,133,.22));
  border-right:1px solid rgba(27,87,133,.55); border-top:1px solid rgba(27,87,133,.55);
}

/* Choices تحت الشات */
.choices{padding:12px 14px; border-top:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.05);
  display:grid; grid-template-columns:1fr 1fr; gap:12px; align-items:start
}
.choices .col{display:grid; gap:10px}
.choice{
  display:flex; align-items:center; gap:10px; padding:10px 12px;
  border-radius:12px; cursor:pointer; user-select:none;
  background: linear-gradient(180deg, rgba(33,37,46,.85), rgba(13,16,22,.85));
  border:1px solid rgba(255,255,255,.12); color:#eaf2ff;
  transition:.12s ease transform, .12s ease filter; box-shadow:0 8px 24px rgba(0,0,0,.25);
}
.choice:hover{filter:brightness(1.07); transform:translateY(-1px)}
.choice .num{width:28px; height:28px; border-radius:8px; display:grid; place-items:center;
  background: linear-gradient(180deg, rgba(27,87,133,.35), rgba(27,87,133,.15));
  border:1px solid rgba(27,87,133,.55); color:#aee3ff; font-weight:900}
.choice .label{flex:1}
.hint{grid-column:1/-1; text-align:center; font-size:12px; color:#d7e9ff; opacity:.85}

/* ===== Shop: Bottom-Right Sheet داخل اللوح ===== */
.shop-sheet{
  position:absolute; right:14px; bottom:14px;
  width: min(420px, 36%); height: 56%;
  border:1px solid rgba(255,255,255,.12); border-radius:16px;
  background: rgba(18,22,31,.92); color:#eaf2ff;
  box-shadow: 0 18px 48px rgba(0,0,0,.55);
  overflow:hidden;
  transform: translateY(calc(100% + 16px)); opacity:0; pointer-events:none;
  transition: transform .22s ease, opacity .22s ease;
}
.shop-sheet.open{ transform: translateY(0); opacity:1; pointer-events:auto; }
.shop-head{display:flex; align-items:center; justify-content:space-between; padding:12px; border-bottom:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.04)}
.shop-head .title{font-weight:900; letter-spacing:.4px}
.sclose{width:34px; height:34px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:#fff; font-size:20px; cursor:pointer}
.shop-list{padding:12px; height:calc(100% - 56px); overflow:auto; display:grid; gap:10px}
.item{
  display:grid; grid-template-columns:56px 1fr auto auto; align-items:center; gap:10px;
  border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:10px;
  background: rgba(33,37,46,.70);
}
.item img{width:56px; height:56px; object-fit:contain; background:#12161f; border-radius:10px}
.item .name{font-weight:900}
.item .type{font-size:12px; color:#b9d2ff}
.price{
  font-weight:900; color:#fff; padding:6px 10px; border-radius:999px;
  border:1px solid rgba(27,87,133,.55);
  background: linear-gradient(180deg, rgba(27,87,133,.35), rgba(27,87,133,.15));
}
.buy{margin-left:6px; padding:8px 12px; border-radius:10px; cursor:pointer;
  border:1px solid rgba(255,255,255,.18); color:#EAF2FF;
  background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
}
.buy:hover{filter:brightness(1.06)}
.buy[disabled]{opacity:.45; cursor:not-allowed}

@media (max-width: 980px){
  .board{grid-template-columns:1fr; height:92vh}
  .dialog-col{border-right:0}
  .choices{grid-template-columns:1fr}
  .shop-sheet{width:min(94%,560px)}
}
